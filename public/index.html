<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω Sinh Vi√™n (NodeJS + Mongo)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container py-5" style="max-width: 800px;">
        <h2 class="text-center text-primary mb-4">üéì Qu·∫£n L√Ω Sinh Vi√™n</h2>
        <h1>Nguy·ªÖn Quang Vinh DH52201762 T5Ca2</h1>
        <div class="card p-4 mb-4 shadow-sm">
            <div class="row g-2">
                <div class="col-md-3">
                    <input type="text" id="code" class="form-control" placeholder="MSSV">
                </div>
                <div class="col-md-4">
                    <input type="text" id="name" class="form-control" placeholder="H·ªç t√™n">
                </div>
                <div class="col-md-3">
                    <input type="text" id="department" class="form-control" placeholder="Khoa">
                </div>
                <div class="col-md-2">
                    <button class="btn btn-success w-100" onclick="addStudent()">Th√™m sinh vien</button>
                </div>
            </div>
        </div>

        <div class="card shadow-sm">
            <div class="card-body">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>MSSV</th>
                            <th>H·ªç T√™n</th>
                            <th>Khoa</th>
                            <th>H√†nh ƒë·ªông</th>
                        </tr>
                    </thead>
                    <tbody id="list">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const API = '/api/students';

        // H√†m t·∫£i danh s√°ch
        async function load() {
            try {
                const res = await fetch(API);
                const data = await res.json();
                const html = data.map(s => `
                    <tr>
                        <td>${s.code}</td>
                        <td><strong>${s.name}</strong></td>
                        <td>${s.department}</td>
                        <td><button class="btn btn-danger btn-sm" onclick="del('${s._id}')">X√≥a</button></td>
                    </tr>
                `).join('');
                document.getElementById('list').innerHTML = html;
            } catch (e) { console.error(e); }
        }

        // H√†m th√™m sinh vi√™n
        async function addStudent() {
            const code = document.getElementById('code').value;
            const name = document.getElementById('name').value;
            const department = document.getElementById('department').value;
            
            if(!code || !name) return alert('Vui l√≤ng nh·∫≠p ƒë·ªß th√¥ng tin!');

            await fetch(API, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({code, name, department})
            });
            
            // Clear form
            document.getElementById('code').value = '';
            document.getElementById('name').value = '';
            document.getElementById('department').value = '';
            load();
        }

        // H√†m x√≥a sinh vi√™n
        async function del(id) {
            if(confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a sinh vi√™n n√†y?')) {
                await fetch(`${API}/${id}`, {method: 'DELETE'});
                load();
            }
        }

        // T·∫£i d·ªØ li·ªáu khi m·ªü web
        load();
    </script>
</body>
</html>